# Redis Helm Values - Master + 2 Replicas with Sentinel
#
# SWARM EQUIVALENT: Your deployments/redis-stack/prod/redis.yml runs a SINGLE Redis:
#   services:
#     redis:
#       image: redis:8.4-alpine
#       command: redis-server --appendonly yes
#       healthcheck:
#         test: ["CMD", "redis-cli", "ping"]
#
# This K8s version runs 3 nodes with Sentinel (automatic failover):
#   - 1 Master (accepts reads + writes)
#   - 2 Replicas (accept reads, promoted to master if master dies)
#   - 3 Sentinel processes (monitor master, trigger failover)
#
# Install with:
#   helm install redis bitnami/redis -n databases -f helm-values.yaml
#
# The Helm chart creates:
#   - StatefulSet: redis-master-0 + redis-replicas-0, redis-replicas-1
#   - Service: redis-master.databases.svc (always points to current master)
#   - Service: redis-replicas.databases.svc (load-balances reads)
#   - PVCs: 3 x 8Gi persistent volumes

architecture: replication

replica:
  replicaCount: 2

sentinel:
  enabled: true
  quorum: 2

master:
  persistence:
    size: 8Gi
  resources:
    limits:
      memory: 512Mi
    requests:
      memory: 128Mi
      cpu: 50m

replica:
  persistence:
    size: 8Gi
  resources:
    limits:
      memory: 512Mi
    requests:
      memory: 128Mi
      cpu: 50m

auth:
  password: "secret"
